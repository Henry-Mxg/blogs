<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>心跳连接 | 一大口麻辣拌的博客</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="总要尝遍所有的路，再对生活充满期待">
    
    <link rel="preload" href="/blogs/assets/css/0.styles.27b443b7.css" as="style"><link rel="preload" href="/blogs/assets/js/app.906672bb.js" as="script"><link rel="preload" href="/blogs/assets/js/3.7b24e10b.js" as="script"><link rel="preload" href="/blogs/assets/js/1.8b97a1ee.js" as="script"><link rel="preload" href="/blogs/assets/js/14.9bd63447.js" as="script"><link rel="prefetch" href="/blogs/assets/js/10.8b3e8273.js"><link rel="prefetch" href="/blogs/assets/js/11.d6fb598b.js"><link rel="prefetch" href="/blogs/assets/js/12.61d899db.js"><link rel="prefetch" href="/blogs/assets/js/13.2c49561c.js"><link rel="prefetch" href="/blogs/assets/js/15.53e906c2.js"><link rel="prefetch" href="/blogs/assets/js/16.6b5f949c.js"><link rel="prefetch" href="/blogs/assets/js/17.2b769064.js"><link rel="prefetch" href="/blogs/assets/js/18.53dbe7f0.js"><link rel="prefetch" href="/blogs/assets/js/19.cb0945fd.js"><link rel="prefetch" href="/blogs/assets/js/20.2bb9787f.js"><link rel="prefetch" href="/blogs/assets/js/4.f315bc31.js"><link rel="prefetch" href="/blogs/assets/js/5.ff90a326.js"><link rel="prefetch" href="/blogs/assets/js/6.cf3a30f3.js"><link rel="prefetch" href="/blogs/assets/js/7.3512f90a.js"><link rel="prefetch" href="/blogs/assets/js/8.e8f03139.js"><link rel="prefetch" href="/blogs/assets/js/9.f9cd7c8d.js">
    <link rel="stylesheet" href="/blogs/assets/css/0.styles.27b443b7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>一大口麻辣拌的博客</h3> <p class="description" data-v-59e6cb88>总要尝遍所有的路，再对生活充满期待</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs/" class="home-link router-link-active"><img src="/blogs/Icon.jpeg" alt="一大口麻辣拌的博客" class="logo"> <span class="site-name">一大口麻辣拌的博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/categories/前端/" class="nav-link"><i class="undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/微前端/" class="nav-link"><i class="undefined"></i>
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/随笔记/" class="nav-link"><i class="undefined"></i>
  随笔记
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      一大口麻辣拌 的博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2476540635913351" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Henry-Mxg/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/blogs/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/blogs/Icon.jpeg" alt="author-avatar" class="personal-img" data-v-1fad0c41> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>9</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>8</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/blogs/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/categories/前端/" class="nav-link"><i class="undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/微前端/" class="nav-link"><i class="undefined"></i>
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/随笔记/" class="nav-link"><i class="undefined"></i>
  随笔记
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      一大口麻辣拌 的博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2476540635913351" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Henry-Mxg/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/blogs/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>心跳连接</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title">心跳连接</h1> <div data-v-8a445198><!----> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>6/2/2023</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>前端</span><span class="tag-item" data-v-8a445198>随笔</span></i></div></div> <div class="theme-reco-content content__default"><img src="data:image/png;base64,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" style="width:800px;"> <h2>前言</h2> <p style="text-indent:2em;"><strong>websocket心跳机制：</strong>顾名思义，就是客户端每隔一段时间向服务端发送一个特有的心跳消息，每次服务端收到消息后只需将消息返回，此时，若二者还保持连接，则客户端就会收到消息，若没收到，则说明连接断开，此时，客户端就要主动重连，完成一个周期</p> <p style="text-indent:2em;">心跳的实现也很简单，只需在第一次连接时用回调函数做延时处理，此时还需要设置一个心跳超时时间，若某时间段内客户端发送了消息，而服务端未返回，则认定为断线。</p> <li>即时通讯大纲</li> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 申请一个WebSocket对象，参数是服务端地址，同http协议使用http://开头一样，</span>
<span class="token comment">// WebSocket协议的url使用ws://开头，另外安全的WebSocket协议使用wss://开头</span>
<span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;ws://localhost:8080&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// 当WebSocket创建成功时，触发onopen事件</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 调用心跳包并停止不断重连 </span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将消息发送到服务端</span>
<span class="token punctuation">}</span>
<span class="token comment">// 当客户端收到服务端发来的消息时，触发onmessage事件，参数e.data包含server传递过来的数据</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 当客户端收到服务端发送的关闭连接请求时，触发onclose事件</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 如果出现连接、处理、接收、发送数据失败的时候触发onerror事件</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><li>心跳包</li> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">// 心跳包 </span>
    <span class="token function">startHeartCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>isDestroyed<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopHeartCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// logger.log(`设定在${this.heartCheckTimeOut}毫秒后发送心跳包`);</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>timeOutId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>websock <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>websock<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// logger.log(&quot;发送心跳包&quot;);</span>
          <span class="token keyword">let</span> msg <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
          msg<span class="token punctuation">.</span>action <span class="token operator">=</span> protocol<span class="token punctuation">.</span><span class="token constant">HEARTBEAT</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startHeartCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">//如果要发心跳包了但是发现连接关闭了则进行断线重连 等到重连上之后自然会又开始发心跳包</span>
          <span class="token comment">// logger.log(&quot;将要发送心跳包，但发现连接关闭，开始尝试重新连接&quot;);</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startProcessReconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heartCheckTimeOut<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><li>停止发送心跳包</li> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 停止发送心跳包 </span>
    <span class="token function">stopHeartCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timeOutId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// logger.log(&quot;停止发送心跳包&quot;);</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timeOutId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>timeOutId <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><li>重新连接</li> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">// 重新连接 </span>
    <span class="token function">startProcessReconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>isDestroyed<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//停止心跳包</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopHeartCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 再连接下一次心跳连接的时候 一定清除第一次 小优化 </span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopProcessReconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// this.initWebSocket();</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>repeatId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//只需要再第一次连接时用回调函数做延迟处理</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 心跳超出时间</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><li>停止不断重连</li> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">stopProcessReconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>repeatId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>repeatId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>repeatId <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>先连接推送服务 创建websocket实例  创建成功 触发onopen事件 并通过send方法将JSON数据发送给服务端</p> <p style="text-indent:2em;">如果客户端接收到服务端发送的消息  触发onmessage事件 监听服务器传过来的数据e.data  并将e.data从JSON格式转换成对象的格 式 如果有e.data.data数据  判断数据是那一种 再在vuex中来进行接下来的操作  然后在对应的页面用map取出来渲染   如果data.success为false的话 就触发了onclose事件 重新连接 </p> <p style="text-indent:2em;">如果推送的有数据并且用户内容存在的时候  每隔40秒就像服务端推送一次数据  维持连接不中断  如果连接失败  再连接下一次心跳连接的时候 清除第一次的像state里面的ws、wsInterval  并再次重新连接  重新走一遍连接推送服务就可以了</p></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:0;" data-v-b57cc07c data-v-7dd95ae2></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:-1;" data-v-248d85d6></canvas></div><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/blogs/assets/js/app.906672bb.js" defer></script><script src="/blogs/assets/js/3.7b24e10b.js" defer></script><script src="/blogs/assets/js/1.8b97a1ee.js" defer></script><script src="/blogs/assets/js/14.9bd63447.js" defer></script>
  </body>
</html>
